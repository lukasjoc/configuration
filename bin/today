#!/bin/bash

current_todo=$HOME/todo/$(date +'%m')_$(date +'%y')/$(date +'%d.%m.%y').md

if [ $# -le 0 ]; then
	cat $current_todo
fi

if [[ $1 == "--save" ]]; then
	cd $HOME/todo
  git add $current_todo
	git commit -m "Add current todo $(date +'%d.%m.%y').md"
	git push
	cd -
fi

if [[ $1 == "--sync" ]]; then
	cd $HOME/todo
	git checkout master && git pull --rebase --stat origin master
	cd -
fi

if [[ $1 == "--update-today" ]]; then
	$EDITOR $current_todo
fi

# print help
if [[ $1 == "--help" || $# -gt 1 ]]; then
  printf '%s\n\n' "List current todo and save current todo"
  printf '%s\n' "Usage:"
  printf '%s\n\n'  " today [--help,--save]"
  printf '%s\n' "Flags:"
  printf '%s\n' "	--help | help for this bash script"
  printf '%s\n' "	--update-today | update current todo (default: $EDITOR)"
  printf '%s\n' "	--save | save current todo repository"
  printf '%s\n' "	--sync | sync current todo repository"
  exit 1
fi

